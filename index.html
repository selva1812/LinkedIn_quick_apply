<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>LinkedIn Sign Up</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    #status { margin-top: 20px; font-weight: bold; color: green; }
  </style>
</head>
<body>
  <h1 id="welcome">Welcome!</h1>
  <button onclick="window.location.href='https://www.linkedin.com/oauth/v2/authorization?response_type=code&client_id=861dobxdvauyy5&redirect_uri=https%3A%2F%2Fselva1812.github.io%2Flinkedin_sign_up%2F&scope=r_liteprofile%20r_emailaddress';">
  Sign in with LinkedIn
</button>
';">
  Sign in with LinkedIn
  </button>
  <p id="info"></p>
  <p id="status"></p> <!-- ✅ Status message -->

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const name = urlParams.get("name");
    const email = urlParams.get("email");
    const title = urlParams.get("title");
    const url = urlParams.get("url");

    if (name && email) {
      document.getElementById("welcome").textContent = `Welcome, ${name}!`;
      document.getElementById("info").innerHTML = `
        <strong>Email:</strong> ${email}<br>
        <strong>Job Title:</strong> ${title}<br>
        <strong>LinkedIn:</strong> <a href="${url}" target="_blank">${url}</a>
      `;

      // Send data to Google Sheet
      fetch("https://script.google.com/a/macros/samsara.com/s/AKfycbwksXbqspTQmXl7iXI-znV-9MxFsJ0xiQYqxXD5tNjv0GdjpvK9kT12YBxsYBS0_FOX/exec", {
        method: "POST",
        body: JSON.stringify({ name, email, title, url }),
        headers: { "Content-Type": "application/json" },
      })
        .then((res) => res.text())
        .then((msg) => {
          console.log("Google Sheet response:", msg);
          document.getElementById("status").textContent =
            "✅ Your information has been saved successfully!";
        })
        .catch((err) => {
          console.error("Error sending to Google Sheet:", err);
          document.getElementById("status").textContent =
            "❌ There was a problem saving your info. Please try again.";
          document.getElementById("status").style.color = "red";
        });
    }
  </script>
</body>
</html>
